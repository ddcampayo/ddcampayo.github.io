<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Daniel Duque</title>

    <meta name="description" content="Talk at UW">
    <meta name="author" content="Daniel Duque">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/black.css" id="theme">

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!--[if lt IE 9]>
	<script src="lib/js/html5shiv.js"></script>
	<![endif]-->
  </head>

  <body>

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">

	<section>
	  <h3>Daniel Duque Campayo</h3>
	  <p>Welcome to my personal website // Bienvenido a mi p√°gina personal </p>

	  <p>Links / Enlaces </p>
	  <ul>
	    <li>
	      <A HREF="Curso_CFD_2019/index.html">UPM CFD course 2018/2019</a>
	    </li>
	    <li>
	      <A HREF="Curso_CFD_2018/index.html">UPM CFD course 2017/2018</a>
	    </li>
	    <li>
	      <A HREF="Curso_CFD_OS/index.html">UPM undergrad CFD course 2017/2018</a>
	    </li>
	    <li>
	      <A HREF="Curso_CFD/index.html">UPM CFD course 2016/2017</a>
	    </li>
	    <li>
	      <A HREF="./Camley_Brown.html">Seminar on Camley and Brown's work</a>
	    </li>
	    <li>
	      <A HREF="SPHeric_2018/index.html">SPHeric 2018 talk</a>
	    </li>
	  </ul>
	</section>


	
	<section>
	  <h1>References</h1>
	  <br>
	  <br>
	  Created with <A HREF="http://lab.hakim.se/reveal-js"> 
	    reveal.js, the HTML Presentation Framework
	  </a>
	</section>
	



      </div>

    </div>


    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>


    <script>

      // More info https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
      controls: true,
      progress: true,
      history: true,
      center: true,
      math: {
      mathjax: 'https://cdn.mathjax.org/mathjax/latest/MathJax.js',
//      mathjax: './MathJax/MathJax.js',
      config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
//      config: 'TeX-AMS_SVG'  // See http://docs.mathjax.org/en/latest/config-files.html
      },

      zoomKey: 'shift',

      transition: 'slide', // none/fade/slide/convex/concave/zoom

      // More info https://github.com/hakimel/reveal.js#dependencies
      dependencies: [
      { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'plugin/zoom-js/zoom.js', async: true },
      { src: 'plugin/notes/notes.js', async: true },
      { src: 'plugin/math/math.js', async: true }
      ]
      });

      Reveal.configure({
        keyboard: {
          39: 'next' // go to the next slide when right arrow key is pressed
        }
      });
    </script>
  </body>
</html>









	  <h2>Particle-in-cell idea</h2>
	  <section data-transition="fade">
	    <blockquote>
	      &ldquo;You don't have to move <em>all</em> your particles, you may
	      keep some fixed, as in the old Particle-in-Cell method&rdquo;
	      <br>
	      <br>
	      &nbsp;&nbsp;&nbsp;&nbsp;
	      J Monaghan, SPHeric 2015 at Parma
	    </blockquote>
	  </section>
          <section data-transition="fade">
 	    <img width="400"  data-src="./motivation_1.svg" alt="Motivation picture">
	    <br>
	    Starting with particles + velocity values
	  </section>
          <section data-transition="fade">
 	    <img width="400"  data-src="./motivation_2.svg" alt="Motivation picture">
	    <br>
	    Let's <em>project</em> onto a fixed mesh
	  </section>
          <section data-transition="fade">
 	    <img width="400"  data-src="./motivation_3.svg" alt="Motivation picture">
	    <br>
	    Using some triangulation (pFEM style)
	  </section>
          <section data-transition="fade">
 	    <img width="400"  data-src="./motivation_4.svg" alt="Motivation picture">
	    <br>
	    The problem is on the mesh only
	  </section>
          <section data-transition="fade">
 	    <img width="400"  data-src="./motivation_5.svg" alt="Motivation picture">
	    <br>
	    We compute new velocities (and pressure)
	  </section>
          <section data-transition="fade">
 	    <img width="400"  data-src="./motivation_6.svg" alt="Motivation picture">
	    <br>
	    We project back onto the particles ...
	  </section>
          <section data-transition="fade">
 	    <img width="400"  data-src="./motivation_7.svg" alt="Motivation picture">
	    <br>
	    Particles are finally moved, Lagrangian-ly
	  </section>
          <section data-transition="fade">
	  <h2>Possible advantages</h2>
	  <ul>
	    <li	 class="fragment fade-up"> From particles: linear algebra may be done once !!</li>
	    <li	 class="fragment fade-up"> From particles: easier boundary conditions and FSI</li>
	    <li	 class="fragment fade-up"> From mesh: avoidance of false diffusion through particles </li>
	  </ul>
	  </section>
	</section>

	<section id="pFEM">
	  <h2>pFEM simulations</h2>
	  <table style="width:100%">
	    <tr>
	      <td align="center" valign="middle">
		<video width="350" controls="controls">
		  <source data-src="./movie_pfem.mp4" type="video/mp4">
		</video>
		<br>
		p-FEM:
		<br>
		particle + FEM
	      </td>
	      <td align="center" valign="middle">
		<video width="350" controls="controls">
		  <source data-src="./movie_pfem2.mp4" type="video/mp4">
		</video>
		<br>
		proj-FEM:
		<br>
		particle + ( mesh + FEM )
	      </td>
	    </tr>
	  </table>
	</section>

	<section id="pFEM">
	  <h2>The problem with projection</h2>

	  <p>Unfortunately, projection may spoil convergence
	  <br>
	  $\frac{d A}{d t} = Q$ &nbsp;&nbsp;&nbsp;&nbsp;
	  $  \frac{d r }{d t} = u $
	  </p>
	  <br>
	  <span class="fragment">
	    $
	    E=
	    T
            $
            <span class="fragment highlight-red">
             $
	      (\Delta t)^2
             $
            </span>
            $
	    \left(
	    \ddot{Q} +    \frac{Q'' u_0^2}{ \mathrm{Co}^2}
	    \right)
	    $
	  </span>
	  <span class="fragment">
	    $
	    +
	    \underbrace{T
            \color{red}{
	    (\Delta t)}
	    A''     \frac{ u_0^2 }{  \mathrm{Co}_h^2}
	    \left(
	    1+
	    \frac{1}{ m^2}
	    \right)
	    }_\mathrm{proj}
	    $
	  </span>
	  <br>
	  <span class="fragment">
	    But, this can be fixed!
	  </span>
	</section>

	<section id="projection">
	  <h2>Improving projection</h2>

	  <p>The former holds for <em>linear</em> projection !</p>
	  <span class="fragment">
	    $
	    E=
	    T
            \color{red}{
	    (\Delta t)^2
            }
	    \left(
	    \ddot{Q} +    \frac{Q'' u_0^2}{ \mathrm{Co}^2}
	    \right)
	    +
	    \underbrace{T
            \color{red}{
	    (\Delta t)
            }
	    A''     \frac{ u_0^2 }{  \mathrm{Co}_h^2}
	    \left(
	    1+
	    \frac{1}{ m^2}
	    \right)
	    }_\mathrm{proj}
	    $
	  </span>
	  <br>
	  <span class="fragment">
            with a quadratic projection:
	    <br>
	    $
	    E=
	    T
            \color{red}{
	    (\Delta t)^2
            }
	    \left(
	    \ddot{Q} +    \frac{Q'' u_0^2}{ \mathrm{Co}^2}
	    \right)
	    +
	    \underbrace{T
            \color{red}{
	    (\Delta t)^2
            }
	    A''' u_0^3
	    \left(
	    \frac{1}{  \mathrm{Co}_H^3} +
	    \frac{1}{  \mathrm{Co}_h^3} 
	    \right)
	    }_\mathrm{proj}
	    $
	    <!-- </p> -->
	  </span>
	  <br>
	  <span class="fragment">
	    ... or the offending term can be made small by
	    particle crowding
	  </span>
	</section>
	
	<section id="Zalesak">
	  <h2>Zalesak's disk</h2>
	  <table  border="1"  style="width:100%">
	    <tr>
	      <td>  </td>
	      <td align="center" valign="middle">
		<small> Linear FE </small> </td>
	      <td align="center" valign="middle">
		<small> Quad mesh  </small> </td>
	      <td align="center" valign="middle">
		<small> Quad mesh + parts  </small></td>
	    </tr>
	    <tr>
	      <td><small> Equal parts. mesh</small></td>
	      <td align="center" valign="middle">
		<video width="200" controls="controls">
		  <source data-src="./movie_coarse.mp4" type="video/mp4">
		</video>
	      </td>
	      <td align="center" valign="middle">
		<video width="200" controls="controls">
		  <source data-src="./movie_coarse_qmesh.mp4" type="video/mp4">
		</video>
	      </td>
	      <td align="center" valign="middle">
		<video width="200" controls="controls">
		  <source data-src="./movie_coarse_qmesh_qpart.mp4" type="video/mp4">
		</video>
	      </td>
	    </tr>
	    <tr>
	      <td><small> Part crowding </small></td>
	      <td align="center" valign="middle">
		<video width="200" controls="controls">
		  <source data-src="./movie_fine.mp4" type="video/mp4">
		</video>
	      </td>
	      <td align="center" valign="middle">
		<video width="200" controls="controls">
		  <source data-src="./movie_fine_qmesh.mp4" type="video/mp4">
		</video>
	      </td>
	      <td align="center" valign="middle">
		<video width="200" controls="controls">
		  <source data-src="./movie_fine_qmesh_qpart.mp4" type="video/mp4">
		</video>
	      </td>
	    </tr>
	  </table>
	</section>



	<section id="TG">
	  <h2>Taylor-Green vortex sheet</h2>
	  <table style="width:100%">
	    <tr>
	      <td align="center" valign="middle">
		<video width="250" controls="controls">
		  <source data-src="./movie_TG_pfem.mp4" type="video/mp4">
		</video>
		<br>
		<small>
		  pFEM
		</small>
	      </td>
	      <td align="center" valign="middle">
		<video width="250" controls="controls">
		  <source data-src="./movie_TG_mesh.mp4" type="video/mp4">
		</video>
		<br>
		<small>
		projFEMq
		</small>
	      </td>
	    </tr>
	    <tr>
	      <td align="center" valign="middle">
		<video width="250" controls="controls">
		  <source data-src="./movie_TG_quad.mp4" type="video/mp4">
		</video>
		<br>
		<small>
		  projFEMq
		</small>
	      </td>
	      <td align="center" valign="middle">
		<video width="250" controls="controls">
		  <source data-src="./movie_TG_fem6.mp4" type="video/mp4">
		</video>
		<br>
		<small>
		  projFEM6
		</small>
	      </td>
	    </tr>
	  </table>
	</section>


	<section id="L2">
	  <h2>Errors for Taylor-Green</h2>
	  <h3>Velocity err vs $\Delta t$</h3>
          <section data-transition="fade">
 	    <img width="500"  data-src="./L2x_v_vs_Dt_1.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="500"  data-src="./L2x_v_vs_Dt_2.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="500"  data-src="./L2x_v_vs_Dt_3.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="500"  data-src="./L2x_v_vs_Dt_4.svg">
	  </section>
	</section>

	<section id="L2-p">
	  <h2>Errors for Taylor-Green</h2>
	  <h3>Pressure err vs $\Delta t$</h3>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_p_vs_Dt_1.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_p_vs_Dt_2.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_p_vs_Dt_3.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_p_vs_Dt_4.svg">
	  </section>
	</section>

	

	<section id="L2-CPU">
	  <h2>Errors for Taylor-Green</h2>
	  <h3>Velocity err vs CPU time</h3>
	  <br>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_v_vs_time_1.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_v_vs_time_2.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_v_vs_time_3.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_v_vs_time_4.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_v_vs_time_5.svg">
	  </section>
	</section>

	

	<section id="L2-p-CPU">
	  <h2>Errors for Taylor-Green</h2>
	  <h3>Pressure err vs CPU time</h3>
	  <br>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_p_vs_time_1.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_p_vs_time_2.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_p_vs_time_3.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_p_vs_time_4.svg">
	  </section>
          <section data-transition="fade">
 	    <img width="600"  data-src="./L2x_p_vs_time_5.svg">
	  </section>
	</section>


	<section id="RT">
	  <h2>Rayleigh-Taylor instability</h2>
          <section data-transition="fade">
	  </section>
          <section data-transition="fade">
	  <table>  <!-- style="width:100%"> -->
	    <tr>
	      <td>
		<video width="120" controls autoplay>
		  <source data-src="./movie_RT_pfem.mp4" type="video/mp4">
		</video>
		<br>
		pFEM
	      </td>
	      <td>
		<video width="120" controls autoplay>
		  <source data-src="./movie_RT.mp4" type="video/mp4">
		</video>
		<br>
		projFEMq
	      </td>
	      <td>
		<video width="120" controls autoplay>
		  <source data-src="./movie_RT_projfem6.mp4" type="video/mp4">
		</video>
		<br>
		projFEM6
	      </td>
	      <td>
		<video width="120" controls autoplay>
		  <source data-src="./movie_RT_OF.mp4" type="video/mp4">
		</video>
		<br>
		OpenFOAM
	      </td>
	    </tr>
	  </table>
	  </section>
	</section>


	<section id="KH">
	  <h2>Extra: Kelvin-Helmholtz instability</h2>
          <section data-transition="fade">
	  </section>
          <section data-transition="fade">
	    <br>
	    <br>
	    <table style="width:100%">
	      <tr>
		<td>
		  <video width="400" controls autoplay>
		    <source data-src="./movie_KH_pfem.mp4" type="video/mp4">
		  </video>
		  <br>
		  <small> pFEM</small>
		</td>
		<td>
		  <video width="400" controls autoplay>
		    <source data-src="./movie_KH_embed.mp4" type="video/mp4">
		  </video>
		  <br>
		  <small> projFEMq</small>
		</td>
	      </tr>
	    </table>
	  </section>
	</section>

	<section id="Conclusions">
	  <h2>Conclusions</h2>
	  <ul>
	    <li	 class="fragment fade-up"> Linear projection is not a good idea ... </li>
	    <li	 class="fragment fade-up"> but quadratic projection is.</li>
	    <li	 class="fragment fade-up"> Future: Other boundaries, free surface.</li>
	    <li	 class="fragment fade-up"> Future: quadratic FEM + better time integrator.</li>
	  </ul>
	</section>

	<!-- <section id="Thanks" data-background="./OMAE.svg"> -->
	<section id="Thanks">
	  <h2>Thank you for your attention</h2>
 	    <img width="700"  data-src="./OMAE.svg">
	</section>

	<section id="extras">
	  <h2>CGAL programming</h2>

           <pre><code class="hljs" data-trim contenteditable>
void areas(Triangulation& T) {

  for(F_f_it fc=T.finite_faces_begin();
      fc!=T.finite_faces_end();
      fc++) {

    Periodic_triangle pt=T.periodic_triangle(fc);

    Triangle t=T.triangle(pt);

    fc->area=t.area();

  }

  return;
}
          </code></pre>
	</section>

